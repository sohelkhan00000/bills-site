var hotelBill=()=>{class l{constructor(){let t={"template-1":"#template-1","template-2":"#template-2","download-pdf":"#download-pdf","spinner-grow":".spinner-grow","download-text":".download-text","modal-btn":"#modal-btn","modal-template":"#modal-template"},a={templates:"[name='templates']","data-fm":"[data-fm]"};Object.keys(t).forEach(e=>{this[e]=document.querySelector(n+" "+t[e])}),Object.keys(a).forEach(e=>{this[e]=document.querySelectorAll(n+" "+a[e])})}}let o={},a={},d={},r=new Date,c,n="hotel-bill",t,m="hotel-bill-data.js";let i=!1,p=!1,s=!1,u={};var y=e=>{let a=!0,r=document.getElementsByClassName("validation-message");Object.keys(r).some(function(e){var t;if("block"==r[e].style.display)return t="ErrorAdress"==r[e].id?130:80,t=r[e].getBoundingClientRect().top+window.pageYOffset-t,window.scrollTo({top:t,behavior:"smooth"}),a=!1,r[e].previousElementSibling.focus(),!0}),a?e(!0,"Template ready"):e(!1,"Template not ready")},v=e=>{o["spinner-grow"].style.display="none",o["download-text"].innerHTML="Download"},f=e=>{let t=new Date(e);return t=(t=t.toLocaleDateString("en-LI",{year:"numeric",month:"short",day:"numeric"})).replaceAll("/","-")};setCurrencyCall=t=>{var a,r=document.querySelector('[data-fm="select-currency"]');r.selectedIndex=t,o.currency.querySelector('[data-fm="currency-code"]').checked?d.currency.forEach(e=>{e.querySelectorAll('[data-tm="currency"]').forEach(e=>{e.innerHTML=r.options[t].value})}):(a=(a=(a=(a=r.options[t].innerHTML).split("-").pop()).split(",",1).pop()).split(" ").pop(),d.currency.forEach(e=>{e.querySelectorAll('[data-tm="currency"]').forEach(e=>{e.innerHTML=a})}))};let h=!0;var w=(e,t)=>{var a=document.querySelector("#dynamic-forms-controls");a.insertAdjacentHTML("afterend",'<div data-dynamic="form-control"></div>'),c&&(u[c.attributes["data-tm"].value]=c),c=u[e];document.querySelectorAll("#delivery-invoice-template-wrapper .templates").forEach(e=>{e.remove()});var r,e=document.querySelector("#delivery-invoice-template-wrapper");if(e.appendChild(c),h)for(r in a.remove(),document.querySelectorAll(n+" [data-dynamic]").forEach(e=>{"form-control"==e.attributes["data-dynamic"].value&&(e=e.attributes["data-dynamic"].value,addDynamicHTML(e,hotelBillData[e],!1))}),(o=new l)["download-pdf"].addEventListener("click",()=>{y((e,t)=>{var a;e&&(o["spinner-grow"].style.display="inline-block",o["download-text"].innerHTML="PDF Generating...",e=c.cloneNode(!0),(a=document.createElement("div")).id="pdf-wrapper",a.setAttribute("class","pdf-wrapper"),a.appendChild(e),html2pdf().set({jsPDF:{format:"a4",orientation:"portrait"},html2canvas:{letterRendering:!0,useCORS:!0,logging:!0,scrollX:0,scrollY:0},margin:[0,0,0,0],padding:0,image:{type:"jpeg",quality:2}}).from(a).toPdf().save("Hotel Bill "+server.pdfName).then(e=>{v();try{isSiteReady&&saveLogs("download",{id:"20",pageName:""+server.pageName,template:""+c.attributes["data-tm"].value,metaData:""})}catch(e){}}).catch(e=>{saveLogs("error",{id:"01",pageName:""+server.pageName,eventName:"html2pdf",msg:"PDF download "+e,metaData:""+server.geo})}))})}),d={templates:document.querySelectorAll(n+" .template-wrapper > .templates"),"modal-body":document.querySelector(n+" .modal-body")},o)document.querySelector("[data-tm="+r+"]")&&"template-1"!=r&&"template-2"!=r&&(d[r]=document.querySelectorAll(n+'  [data-tm=" + i + "]')),document.querySelector("[com-tm="+r+"]")&&"template-1"!=r&&"template-2"!=r&&(d[r]=document.querySelectorAll(n+' [com-tm=" + i + "]')),"template-1"!=r&&"template-2"!=r||(d[r]=document.querySelector(n+' .template-wrapper > [data-tm=" + i + "]'));h=!0,t&&t(!0,"Template has switched")},S=e=>{document.querySelector(".loader-wrap").classList.add("d-none"),o=new l,(async(e,t)=>{dragScroller("delivery-invoice-template-wrapper"),d={templates:document.querySelectorAll(`${n} .template-wrapper > .templates`),"modal-body":document.querySelector(`${n} .modal-body`)};for(let e in o){if(document.querySelector(`${n} p[data-error=" + i + "]`))a[e]=document.querySelector(`${n} p[data-error=" + i + "]`);if(document.querySelector("[data-tm="+e+"]")&&e!="template-1"&&e!="template-2")d[e]=document.querySelectorAll(`${n}  [data-tm=" + i + "]`);if(document.querySelector("[com-tm="+e+"]")&&e!="template-1"&&e!="template-2")d[e]=document.querySelectorAll(`${n}  [com-tm=" + i + "]`);if(e=="template-1"||e=="template-2")d[e]=document.querySelector(`${n} .template-wrapper > [data-tm=" + i + "]`)}if(document.querySelectorAll(".date").forEach(e=>{e.innerHTML=f(r)}),p){d["templates"].forEach(e=>{u[e.attributes["data-tm"].value]=e;e.remove()});w(e);o[e].checked=true}if(t)t(true,"page is ready!")})("template-1"),i=i||!0,p&&!s&&(s=!0,o.templates.forEach(t=>t.addEventListener("click",e=>{o.templates.forEach(e=>{e.id!=t.id&&w(t.id)})})),o["modal-btn"].addEventListener("click",e=>{var t;d["modal-body"].innerHTML="",t=c.cloneNode(!0),d["modal-body"].appendChild(t)}),t=new bootstrap.Modal(o["modal-template"]),window.addEventListener("click",function(e){"modal-body"==e.target.classList[0]&&t.toggle()})),e&&e(!0,"Bind Event function called")};{var e=(e,t)=>{e&&(document.querySelectorAll(n+" [data-dynamic]").forEach(e=>{e=e.attributes["data-dynamic"].value;addDynamicHTML(e,hotelBillData[e],!1)}),p=!0,S())},g=document.querySelectorAll("script");let t=!1;g.forEach(e=>{e.src.replace(/^.*[\\\/]/,"")==m&&(t=!0)}),t||((g=document.createElement("script")).src=server.jsPath+"/partialPage/"+m,g.async=!0,g.onload=()=>{e(!0,"Dynamic data loaded")},g.onerror=()=>{e(!1,"Error occurred while loading dynamic data")},document.body.appendChild(g))}};(()=>{let e=setInterval(()=>{isSiteReady?(clearInterval(e),hotelBill()):document.querySelector(".loader-wrap")&&document.querySelector(".loader-wrap").classList.remove("d-none")},100)})();